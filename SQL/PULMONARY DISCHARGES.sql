DECLARE @SD1 DATETIME;
DECLARE @ED1 DATETIME;
DECLARE @SD2 DATETIME;
DECLARE @ED2 DATETIME;
DECLARE @DXCLASSTYPE VARCHAR(10);
DECLARE @DXSCHM VARCHAR(5);

SET @SD1 = '2014-01-01';
SET @ED1 = '2014-10-01';
SET @SD2 = '2015-01-01';
SET @ED2 = '2015-10-01';
SET @DXCLASSTYPE = 'DF';
SET @DXSCHM = '9';

SELECT DISTINCT PAV.PtNo_Num
, DX.PtNo_Num
, DX.ClasfCd
, DX.ClasfSch
, PAV.Dsch_Date
, MONTH(PAV.DSCH_DATE) AS [DISCHARGE MONTH]
, YEAR(PAV.DSCH_DATE) AS [DISCHARGE YEAR]

FROM smsdss.BMH_PLM_PtAcct_V AS PAV
LEFT JOIN smsdss.BMH_PLM_PtAcct_Clasf_Dx_V AS DX
ON PAV.PtNo_Num = DX.PtNo_Num

WHERE PAV.Plm_Pt_Acct_Type = 'I'
AND PAV.PtNo_Num < '20000000'
AND (
	PAV.Dsch_Date >= @SD1 AND PAV.Dsch_Date < @ED1
	OR
	PAV.Dsch_Date >= @SD2 AND PAV.Dsch_Date < @ED2
	)
AND DX.ClasfSch = @DXSCHM
AND DX.SortClasfType = @DXCLASSTYPE
AND DX.ClasfCd IN (
	'135','517.8','235.7','277.0','277.01','277.56',
	'277.81','277.82','277.83','402.1','415.11',
	'415.12','415.13','415.19','416.0','491.2','494.8',
	'492','492.8','491.2','494.1','496','515','516.3',
	'516.31','516.34','710.1','745.4','748.61','770.7'
)